# DQN vs DDQN å®éªŒæ›²çº¿ç»˜åˆ¶è¯´æ˜

**æ—¥æœŸ**: 2026-01-03  
**é¡¹ç›®**: Deep Reinforcement Learning with Double Q-learning

---

## ğŸ“Š æ•°æ®æ¦‚è§ˆ

### å¯ç”¨æ•°æ®æº
| æ¸¸æˆ | ç®—æ³• | æ•°æ®å¤§å° | è·¯å¾„ |
|------|------|----------|------|
| Atlantis | DQN | 8.04 MB | `archive/dqn_atlantis/summary/` |
| Atlantis | DDQN | 11.48 MB | `archive/ddqn_atlantis/summary/` |
| Alien | DQN | 15.09 MB | `log/20260102_181444_DQN_AlienNoFrameskip-v4/summary/` |
| Breakout | DDQN | 18.33 MB | `log/20260101_141106_BreakoutNoFrameskip-v4/summary/` |

---

## ğŸ¯ å·²ç”Ÿæˆçš„å›¾è¡¨

### æ ¸å¿ƒå¯¹æ¯”å›¾ï¼ˆå·²å¯¹é½æ¨ªåæ ‡ï¼‰

1. **1_atlantis_core_aligned.png** (354KB)
   - 3ä¸ªå­å›¾ï¼šQå€¼ä¼°è®¡ã€è®­ç»ƒæ€§èƒ½ã€æµ‹è¯•æ€§èƒ½
   - DQNï¼ˆæ©™è‰²ï¼‰vs DDQNï¼ˆè“è‰²ï¼‰
   - âœ… æ¨ªåæ ‡å·²å¯¹é½

2. **2_atlantis_complete_aligned.png** (561KB)
   - 6ä¸ªå­å›¾ï¼šå®Œæ•´æŒ‡æ ‡åˆ†æ
   - Average Q, Reward, Test Score, Loss, Epsilon, Total Frames
   - âœ… æ¨ªåæ ‡å·²å¯¹é½

3. **3_overestimation_analysis_aligned.png** (330KB)
   - Qå€¼è¿‡ä¼°è®¡æ·±å…¥åˆ†æï¼ˆ4ä¸ªå­å›¾ï¼‰
   - Qå€¼å¯¹æ¯”ã€å·®å¼‚é‡ã€è¿‡ä¼°è®¡ç‡ã€Qå€¼vså¥–åŠ±
   - âœ… æ¨ªåæ ‡å·²å¯¹é½

4. **4_alien_dqn.png** (196KB)
   - Alienæ¸¸æˆçš„DQNå­¦ä¹ æ›²çº¿ï¼ˆ4ä¸ªå­å›¾ï¼‰

5. **5_breakout_ddqn.png** (192KB)
   - Breakoutæ¸¸æˆçš„DDQNå­¦ä¹ æ›²çº¿ï¼ˆ4ä¸ªå­å›¾ï¼‰

---

## ğŸ”§ æ•°æ®å¯¹é½åŸç†

### é—®é¢˜
DQNå’ŒDDQNçš„è®­ç»ƒæ­¥æ•°ä¸åŒï¼Œå¯¼è‡´ï¼š
- DQN: ~19,000 æ•°æ®ç‚¹
- DDQN: ~27,000 æ•°æ®ç‚¹
- æ¨ªåæ ‡é•¿åº¦ä¸ä¸€è‡´ï¼Œæ›²çº¿ç»ˆç‚¹ä¸å¯¹é½

### è§£å†³æ–¹æ¡ˆï¼šå¤šæ•°æœä»å°‘æ•°

```python
def align_data(dqn_steps, dqn_vals, ddqn_steps, ddqn_vals):
    """å¯¹é½æ•°æ® - å¤šçš„æˆªæ–­åˆ°å°‘çš„é•¿åº¦"""
    # æ‰¾åˆ°æœ€å°çš„æœ€å¤§æ­¥æ•°ï¼ˆå¤šæ•°æœä»å°‘æ•°ï¼‰
    dqn_max = dqn_steps[-1] if len(dqn_steps) > 0 else 0
    ddqn_max = ddqn_steps[-1] if len(ddqn_steps) > 0 else 0
    min_max_step = min(dqn_max, ddqn_max)
    
    # æˆªæ–­åˆ°ç›¸åŒçš„æœ€å¤§æ­¥æ•°
    dqn_mask = dqn_steps <= min_max_step
    ddqn_mask = ddqn_steps <= min_max_step
    
    return (dqn_steps[dqn_mask], dqn_vals[dqn_mask],
            ddqn_steps[ddqn_mask], ddqn_vals[ddqn_mask])
```

**æ ¸å¿ƒæ€æƒ³**ï¼š
1. æ¯”è¾ƒä¸¤è€…çš„æ•°æ®é‡
2. ä»¥è¾ƒçŸ­çš„è®­ç»ƒæ­¥æ•°ä¸ºå‡†
3. å°†è¾ƒé•¿çš„æ•°æ®æˆªæ–­
4. ç¡®ä¿ä¸¤æ¡æ›²çº¿çš„æ¨ªåæ ‡ç»ˆç‚¹ä¸€è‡´

---

## ğŸš€ ç»˜å›¾è„šæœ¬ä½¿ç”¨

### 1. æ¿€æ´»ç¯å¢ƒ
```bash
conda activate deep
```

### 2. ç»˜åˆ¶æ‰€æœ‰å›¾è¡¨ï¼ˆæ¨èï¼‰
```bash
cd /root/Deep
python plot_all_curves_fixed.py
```

ç”Ÿæˆçš„å›¾è¡¨ï¼š
- `1_atlantis_core_aligned.png` - æ ¸å¿ƒå¯¹æ¯”
- `2_atlantis_complete_aligned.png` - å®Œæ•´åˆ†æ
- `3_overestimation_analysis_aligned.png` - è¿‡ä¼°è®¡åˆ†æ
- `4_alien_dqn.png` - Alien DQN
- `5_breakout_ddqn.png` - Breakout DDQN

### 3. å•ç‹¬ç»˜åˆ¶Atlantiså¯¹æ¯”
```bash
python plot_atlantis.py
```

### 4. ç»˜åˆ¶æ‰€æœ‰å¯ç”¨æ•°æ®
```bash
python plot_existing_data.py
```

---

## ğŸ“ˆ å¯ç»˜åˆ¶çš„æ›²çº¿ç±»å‹

### A. DQN vs DDQN å¯¹æ¯”æ›²çº¿ï¼ˆAtlantisï¼‰
1. Average Q Value - è¯æ˜DDQNæŠ‘åˆ¶Qå€¼è¿‡ä¼°è®¡ â­â­â­â­â­
2. Training Reward - è®­ç»ƒæ€§èƒ½å¯¹æ¯” â­â­â­â­â­
3. Test Score - æµ‹è¯•æ€§èƒ½å¯¹æ¯” â­â­â­â­
4. Loss - è®­ç»ƒæŸå¤± â­â­â­
5. Epsilon - æ¢ç´¢ç‡ â­â­
6. Total Frames - è®­ç»ƒè¿›åº¦ â­â­

### B. å•ç®—æ³•å­¦ä¹ æ›²çº¿
- Alien DQN: Qå€¼ã€å¥–åŠ±ã€æŸå¤±ã€Epsilon
- Breakout DDQN: Qå€¼ã€å¥–åŠ±ã€æŸå¤±ã€Epsilon

### C. Qå€¼è¿‡ä¼°è®¡åˆ†æ
1. Qå€¼å¯¹æ¯”å›¾
2. Qå€¼å·®å¼‚ï¼ˆDQN - DDQNï¼‰
3. è¿‡ä¼°è®¡ç‡ç™¾åˆ†æ¯”
4. Qå€¼ä¸å®é™…å¥–åŠ±å¯¹æ¯”

---

## ğŸ¨ ç»˜å›¾å‚æ•°é…ç½®

### é¢œè‰²æ–¹æ¡ˆ
```python
DQN_COLOR = '#E57836'      # æ©™è‰²
DDQN_COLOR = '#4A90D9'     # è“è‰²
```

### å¹³æ»‘å‚æ•°
```python
SMOOTH_WEIGHT = 0.9        # æŒ‡æ•°ç§»åŠ¨å¹³å‡æƒé‡
```

### å›¾è¡¨å°ºå¯¸
```python
# æ ¸å¿ƒå¯¹æ¯”ï¼ˆ3å›¾ï¼‰
figsize=(18, 5)

# å®Œæ•´åˆ†æï¼ˆ6å›¾ï¼‰
figsize=(18, 12)

# å­¦ä¹ æ›²çº¿ï¼ˆ4å›¾ï¼‰
figsize=(14, 10)
```

---

## ğŸ“Š TensorBoard æŒ‡æ ‡å¯¹ç…§

| TensorBoardæ ‡ç­¾ | å«ä¹‰ | é‡è¦æ€§ |
|----------------|------|--------|
| `Average Q` | Qå€¼ä¼°è®¡ | â­â­â­â­â­ |
| `Latest 100 avg reward (clipped)` | å¹³å‡å¥–åŠ± | â­â­â­â­â­ |
| `Test score` | æµ‹è¯•å¾—åˆ† | â­â­â­â­ |
| `Loss` | è®­ç»ƒæŸå¤± | â­â­â­ |
| `Epsilon` | æ¢ç´¢ç‡ | â­â­â­ |
| `Total frames` | è®­ç»ƒæ­¥æ•° | â­â­ |
| `Reward (clipped)` | å³æ—¶å¥–åŠ± | â­â­ |

**æ³¨æ„**ï¼šæ ‡ç­¾åç§°å¤§å°å†™æ•æ„Ÿï¼Œä¾‹å¦‚ `Test score` ä¸æ˜¯ `Test Score`

---

## âš ï¸ å¸¸è§é—®é¢˜ä¸è§£å†³

### 1. æ¨ªåæ ‡ä¸å¯¹é½
**é—®é¢˜**ï¼šDQNå’ŒDDQNæ›²çº¿é•¿åº¦ä¸ä¸€è‡´
**è§£å†³**ï¼šä½¿ç”¨ `align_data()` å‡½æ•°ï¼Œå¤šæ•°æœä»å°‘æ•°åŸåˆ™

### 2. å³ä¾§å›¾è¡¨ç©ºç™½
**é—®é¢˜**ï¼šæ ‡ç­¾åç§°å¤§å°å†™é”™è¯¯
**è§£å†³**ï¼šæ£€æŸ¥TensorBoardå®é™…æ ‡ç­¾ï¼Œä½¿ç”¨æ­£ç¡®çš„å¤§å°å†™

### 3. TensorFlowç¯å¢ƒé”™è¯¯
**é—®é¢˜**ï¼š`Duplicate registrations for type 'experimentalOptimizer'`
**è§£å†³**ï¼šä½¿ç”¨ `conda activate deep` æ¿€æ´»æ­£ç¡®çš„ç¯å¢ƒ

### 4. æ•°æ®è¯»å–å¤±è´¥
**é—®é¢˜**ï¼šæ‰¾ä¸åˆ°æ•°æ®æ–‡ä»¶
**è§£å†³**ï¼šç¡®è®¤æ•°æ®è·¯å¾„æ­£ç¡®ï¼Œæ£€æŸ¥ `archive/` å’Œ `log/` ç›®å½•

---

## ğŸ” æ•°æ®éªŒè¯

### æ£€æŸ¥æ•°æ®æ˜¯å¦å­˜åœ¨
```bash
ls -lh archive/*/summary/
ls -lh log/*/summary/
```

### æŸ¥çœ‹è®­ç»ƒæ­¥æ•°
```python
from tensorboard.backend.event_processing import event_accumulator

ea = event_accumulator.EventAccumulator('archive/dqn_atlantis/summary')
ea.Reload()
print(ea.Tags())
```

---

## ğŸ“ ç»˜å›¾è„šæœ¬è¯´æ˜

### plot_all_curves_fixed.py
- ç»˜åˆ¶æ‰€æœ‰5å¼ å›¾è¡¨
- **å·²å®ç°æ•°æ®å¯¹é½**
- è‡ªåŠ¨ç”Ÿæˆ `*_aligned.png` æ–‡ä»¶

### plot_atlantis.py
- ä¸“é—¨ç»˜åˆ¶Atlantiså¯¹æ¯”
- åŒ…å«truncate_to_matchå‡½æ•°
- ç”Ÿæˆ `atlantis_dqn_vs_ddqn.png`

### plot_existing_data.py
- è‡ªåŠ¨æ‰«ææ‰€æœ‰è®­ç»ƒæ—¥å¿—
- ç»˜åˆ¶æ‰€æœ‰å¯ç”¨æ•°æ®
- ç”Ÿæˆ `existing_data_plot.png`

---

## ğŸ“Œ å®éªŒç»“è®º

### ä»å›¾è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼š

1. **Qå€¼æŠ‘åˆ¶**ï¼šDDQNçš„Qå€¼æ˜æ˜¾ä½äºDQNï¼Œè¯æ˜è¿‡ä¼°è®¡è¢«æŠ‘åˆ¶
2. **æ€§èƒ½æå‡**ï¼šDDQNåœ¨æµ‹è¯•æ€§èƒ½ä¸Šä¼˜äºDQN
3. **è®­ç»ƒç¨³å®šæ€§**ï¼šä¸¤ç§ç®—æ³•çš„æŸå¤±æ›²çº¿éƒ½å‘ˆä¸‹é™è¶‹åŠ¿
4. **æ¢ç´¢ç­–ç•¥**ï¼šEpsilonæŒ‰é¢„æœŸä»1.0è¡°å‡åˆ°0.1

### è®ºæ–‡æ ¸å¿ƒéªŒè¯ï¼š
âœ… DDQNæˆåŠŸæŠ‘åˆ¶äº†Qå€¼è¿‡ä¼°è®¡  
âœ… æŠ‘åˆ¶è¿‡ä¼°è®¡æå‡äº†æµ‹è¯•æ€§èƒ½  
âœ… ç®—æ³•åœ¨å¤šä¸ªæ¸¸æˆä¸Šéƒ½æœ‰æ•ˆ

---

## ğŸ¯ åç»­å·¥ä½œ

### å¯è¡¥å……çš„å®éªŒï¼š
1. åœ¨Alienä¸Šè®­ç»ƒDDQNï¼ˆè¡¥å…¨å¯¹æ¯”ï¼‰
2. åœ¨Breakoutä¸Šè®­ç»ƒDQNï¼ˆè¡¥å…¨å¯¹æ¯”ï¼‰
3. å¢åŠ æ›´å¤šæ¸¸æˆçš„å®éªŒæ•°æ®
4. ç»˜åˆ¶æ¶ˆèå®éªŒå›¾ï¼ˆå¤šæ¬¡è®­ç»ƒçš„ç¨³å®šæ€§åˆ†æï¼‰

### å¯ä¼˜åŒ–çš„ç»˜å›¾ï¼š
1. æ·»åŠ è¯¯å·®å¸¦ï¼ˆæ ‡å‡†å·®ï¼‰
2. æ·»åŠ ç»Ÿè®¡æ˜¾è‘—æ€§æ£€éªŒ
3. åˆ¶ä½œåŠ¨ç”»å±•ç¤ºè®­ç»ƒè¿‡ç¨‹
4. ç”ŸæˆLaTeXæ ¼å¼çš„å›¾è¡¨

---

**æœ€åæ›´æ–°**: 2026-01-03  
**æ‰€æœ‰å›¾è¡¨å·²å¯¹é½æ¨ªåæ ‡ï¼Œå¯ç›´æ¥ç”¨äºè®ºæ–‡å’ŒæŠ¥å‘Š** âœ…

---

## ğŸ†• æœ€æ–°ç”Ÿæˆçš„å›¾è¡¨ï¼ˆ2026-01-03ï¼‰

### å®Œæ•´å›¾è¡¨åˆ—è¡¨ï¼ˆå¸¦è·¯å¾„ï¼‰

| åºå· | æ–‡ä»¶å | å¤§å° | å®Œæ•´è·¯å¾„ | è¯´æ˜ |
|------|--------|------|----------|------|
| 1 | `1_atlantis_core_aligned.png` | 354KB | `/root/Deep/1_atlantis_core_aligned.png` | Atlantisæ ¸å¿ƒå¯¹æ¯”3å›¾ï¼ˆå·²å¯¹é½ï¼‰â­â­â­â­â­ |
| 2 | `2_atlantis_complete_aligned.png` | 561KB | `/root/Deep/2_atlantis_complete_aligned.png` | Atlantiså®Œæ•´åˆ†æ6å›¾ï¼ˆå·²å¯¹é½ï¼‰â­â­â­â­â­ |
| 3 | `3_overestimation_analysis_aligned.png` | 330KB | `/root/Deep/3_overestimation_analysis_aligned.png` | Qå€¼è¿‡ä¼°è®¡åˆ†æ4å›¾ï¼ˆå·²å¯¹é½ï¼‰â­â­â­â­â­ |
| 4 | `4_alien_dqn.png` | 196KB | `/root/Deep/4_alien_dqn.png` | Alien DQNå­¦ä¹ æ›²çº¿4å›¾ â­â­â­â­ |
| 5 | `5_breakout_ddqn.png` | 192KB | `/root/Deep/5_breakout_ddqn.png` | Breakout DDQNå­¦ä¹ æ›²çº¿4å›¾ â­â­â­â­ |

### å¿«é€ŸæŸ¥æ‰¾å‘½ä»¤

```bash
# æŸ¥çœ‹æ‰€æœ‰ç”Ÿæˆçš„å›¾è¡¨
ls -lh /root/Deep/*.png

# æŸ¥çœ‹å¯¹é½ç‰ˆæœ¬çš„å›¾è¡¨
ls -lh /root/Deep/*aligned.png

# å¤åˆ¶åˆ°å…¶ä»–ä½ç½®
cp /root/Deep/*_aligned.png /ç›®æ ‡è·¯å¾„/

# ç”¨é»˜è®¤æŸ¥çœ‹å™¨æ‰“å¼€
eog /root/Deep/1_atlantis_core_aligned.png  # Linux
# æˆ–åœ¨Windowsä¸­åŒå‡»æŸ¥çœ‹
```

### å›¾è¡¨ç”¨é€”å»ºè®®

| å›¾è¡¨ | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|----------|--------|
| `1_atlantis_core_aligned.png` | è®ºæ–‡ä¸»è¦ç»“æœå›¾ï¼ŒPPTæ¼”ç¤º | â­â­â­â­â­ |
| `2_atlantis_complete_aligned.png` | æŠ€æœ¯æŠ¥å‘Šï¼Œè¯¦ç»†åˆ†æ | â­â­â­â­â­ |
| `3_overestimation_analysis_aligned.png` | ç†è®ºéªŒè¯ï¼Œæ·±å…¥è®¨è®º | â­â­â­â­â­ |
| `4_alien_dqn.png` | å•ç®—æ³•æ¡ˆä¾‹ç ”ç©¶ | â­â­â­â­ |
| `5_breakout_ddqn.png` | å•ç®—æ³•æ¡ˆä¾‹ç ”ç©¶ | â­â­â­â­ |

---

## ğŸ“Š å›¾è¡¨æŠ€æœ¯ç»†èŠ‚

### æ•°æ®å¯¹é½å®ç°ï¼ˆé‡è¦ï¼ï¼‰

**é—®é¢˜æè¿°**ï¼š
- DQNè®­ç»ƒåˆ° ~19,408 æ­¥
- DDQNè®­ç»ƒåˆ° ~27,591 æ­¥
- ç›´æ¥ç»˜åˆ¶ä¼šå¯¼è‡´æ¨ªåæ ‡é•¿åº¦ä¸ä¸€è‡´

**è§£å†³æ–¹æ¡ˆ**ï¼š
```python
def align_data(dqn_steps, dqn_vals, ddqn_steps, ddqn_vals):
    """å¤šæ•°æœä»å°‘æ•° - æˆªæ–­åˆ°è¾ƒçŸ­çš„è®­ç»ƒæ­¥æ•°"""
    min_max_step = min(dqn_steps[-1], ddqn_steps[-1])
    dqn_mask = dqn_steps <= min_max_step
    ddqn_mask = ddqn_steps <= min_max_step
    return (dqn_steps[dqn_mask], dqn_vals[dqn_mask],
            ddqn_steps[ddqn_mask], ddqn_vals[ddqn_mask])
```

**æ•ˆæœ**ï¼š
- âœ… ä¸¤æ¡æ›²çº¿ç»ˆç‚¹åœ¨åŒä¸€æ¨ªåæ ‡
- âœ… æ•°æ®ç‚¹æ•°é‡ä¸€è‡´
- âœ… ä¾¿äºç›´æ¥å¯¹æ¯”

### ç”Ÿæˆè„šæœ¬å¯¹åº”å…³ç³»

| è„šæœ¬æ–‡ä»¶ | ç”Ÿæˆå›¾è¡¨ | ç‰¹ç‚¹ |
|----------|----------|------|
| `plot_all_curves_fixed.py` | å›¾1-5ï¼ˆå…¨éƒ¨ï¼‰ | **æ¨èä½¿ç”¨**ï¼Œå·²å¯¹é½ |
| `plot_atlantis.py` | Atlantiså¯¹æ¯”å›¾ | å•ç‹¬ç»˜åˆ¶ï¼Œå¿«é€Ÿ |
| `plot_existing_data.py` | è‡ªåŠ¨æ‰«ææ‰€æœ‰æ•°æ® | æ¢ç´¢æ€§åˆ†æ |

### é‡æ–°ç”Ÿæˆå›¾è¡¨

å¦‚æœéœ€è¦é‡æ–°ç”Ÿæˆæ‰€æœ‰å›¾è¡¨ï¼š
```bash
cd /root/Deep
python plot_all_curves_fixed.py
```

å¦‚æœåªéœ€è¦Atlantiså¯¹æ¯”å›¾ï¼š
```bash
cd /root/Deep
python plot_atlantis.py
```

---

## ğŸ¨ å›¾è¡¨å®šåˆ¶è¯´æ˜

### ä¿®æ”¹é¢œè‰²
åœ¨è„šæœ¬ä¸­ä¿®æ”¹ï¼š
```python
DQN_COLOR = '#E57836'      # æ©™è‰²ï¼ˆå¯æ”¹ä¸ºå…¶ä»–é¢œè‰²ï¼‰
DDQN_COLOR = '#4A90D9'     # è“è‰²ï¼ˆå¯æ”¹ä¸ºå…¶ä»–é¢œè‰²ï¼‰
```

### ä¿®æ”¹å¹³æ»‘åº¦
```python
SMOOTH_WEIGHT = 0.9        # å€¼è¶Šå¤§è¶Šå¹³æ»‘ï¼ˆ0.0-1.0ï¼‰
```

### ä¿®æ”¹å›¾è¡¨å°ºå¯¸
```python
figsize=(18, 5)            # å®½åº¦, é«˜åº¦ï¼ˆè‹±å¯¸ï¼‰
dpi=150                    # åˆ†è¾¨ç‡ï¼ˆå¯æ”¹ä¸º200ã€300ç­‰ï¼‰
```

### ä¿®æ”¹å­—ä½“å¤§å°
```python
fontsize=14                # æ ‡é¢˜å­—ä½“
fontsize=10                # åæ ‡è½´æ ‡ç­¾
fontsize=9                 # å›¾ä¾‹å­—ä½“
```

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

åœ¨ä½¿ç”¨å›¾è¡¨å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] æ‰€æœ‰5å¼ å›¾è¡¨å·²ç”Ÿæˆ
- [ ] å›¾è¡¨æ–‡ä»¶å¤§å°æ­£å¸¸ï¼ˆ~200-600KBï¼‰
- [ ] DQNå’ŒDDQNæ›²çº¿æ¨ªåæ ‡å·²å¯¹é½
- [ ] Test Scoreå›¾ä¸æ˜¯ç©ºç™½
- [ ] å›¾ä¾‹æ­£ç¡®æ˜¾ç¤ºï¼ˆDQN=æ©™è‰²ï¼ŒDDQN=è“è‰²ï¼‰
- [ ] æ ‡é¢˜æ¸…æ™°å¯è¯»
- [ ] åæ ‡è½´æ ‡ç­¾å®Œæ•´

---

**æ–‡æ¡£æœ€åæ›´æ–°**: 2026-01-03 20:00  
**æ‰€æœ‰å›¾è¡¨è·¯å¾„å·²è®°å½•ï¼Œå¯ç›´æ¥ä½¿ç”¨** âœ…
